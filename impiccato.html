<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Impiccato ‚Äî Sorpresa!</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f7f7fb;
      --card:#ffffff;
      --accent:#e63946;
      --muted:#7b8ca3;
      --success:#16a34a;
      --glass: rgba(255,255,255,0.6);
      --shadow: 0 6px 20px rgba(18,38,63,0.08);
    }
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial; margin:0; background:linear-gradient(180deg, #f4f7fb 0%, #ffffff 100%); color:#102a43; min-height:100vh; display:flex; align-items:center; justify-content:center; padding:24px}

    .wrap{width:100%; max-width:820px; background:var(--card); border-radius:16px; padding:28px; box-shadow:var(--shadow); display:grid; grid-template-columns: 1fr 360px; gap:20px; align-items:start}

    @media (max-width:900px){ .wrap{grid-template-columns:1fr; padding:20px} .right{order:2} }

    header{display:flex; gap:12px; align-items:center}
    .logo{width:56px; height:56px; border-radius:12px; background:linear-gradient(135deg,#ffbe0b,#fb5607); display:flex; align-items:center; justify-content:center; font-weight:800; color:white; font-size:20px; box-shadow:0 6px 18px rgba(251,86,7,0.18)}
    h1{font-size:20px;margin:0}
    p.lead{margin:6px 0 18px;color:var(--muted)}

    /* left area */
    .left{padding:6px}
    .board{background:linear-gradient(180deg,#ffffff,#fcfdff); border-radius:12px; padding:18px; box-shadow:var(--shadow)}
    .word{display:flex; gap:10px; justify-content:center; margin:18px 0}
    .letter{min-width:40px; height:60px; border-radius:8px; display:flex; align-items:center; justify-content:center; font-weight:700; font-size:20px; background:linear-gradient(180deg,#fbfbff,#f2f6ff); border:1px solid #e6eefb}
    .letter.hidden{background:linear-gradient(180deg,#eef2ff,#f8fbff); color:transparent}

    .keyboard{margin-top:14px; display:grid; grid-template-columns: repeat(10,1fr); gap:8px}
    .key{padding:10px 8px; border-radius:8px; background:var(--glass); border:1px solid rgba(16,42,67,0.06); text-align:center; font-weight:600; cursor:pointer; user-select:none}
    .key.disabled{opacity:0.38; cursor:not-allowed}

    /* right area */
    .right{display:flex; flex-direction:column; gap:14px}
    .hangman-card{background:linear-gradient(180deg,#ffffff,#fbfdff); border-radius:12px; padding:18px; box-shadow:var(--shadow); display:flex; flex-direction:column; align-items:center; gap:12px}
    .svg-wrap{width:260px; height:220px}

    .info{font-size:14px;color:var(--muted); text-align:center}
    .tries{font-weight:700; font-size:18px}

    .controls{display:flex; gap:10px; justify-content:center}
    button.btn{padding:10px 14px; border-radius:10px; border:0; font-weight:700; cursor:pointer}
    .btn.secondary{background:#eef6ff; color:#0b67ff}
    .btn.primary{background:var(--accent); color:white}

    /* win overlay */
    .overlay{position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:linear-gradient(0deg, rgba(2,6,23,0.45), rgba(2,6,23,0.45)); visibility:hidden; opacity:0; transition:all .25s ease}
    .overlay.show{visibility:visible; opacity:1}
    .modal{background:linear-gradient(180deg,#fff,#fdfdfd); padding:28px; border-radius:14px; text-align:center; max-width:520px; box-shadow:0 10px 40px rgba(2,6,23,0.25)}
    .modal h2{margin:0 0 12px; font-size:24px}
    .prize{font-weight:900; color:var(--accent); font-size:20px}
    .sub{color:var(--muted); margin-bottom:18px}

    /* confetti placeholders */
    .confetti{position:absolute; inset:0; pointer-events:none}

    footer{grid-column:1/-1; text-align:center; margin-top:8px; color:var(--muted); font-size:13px}
  </style>
</head>
<body>
  <div class="wrap" role="application" aria-label="Impiccato ">
    <div class="left">
      <header>
        <div class="logo">IT</div>
        <div>
          <h1>Impiccato ‚Äî sorpresa!</h1>
          <p class="lead">Indovina la parola: ogni lettera giusta ti avvicina al premio. Buona fortuna üí´</p>
        </div>
      </header>

      <div class="board" aria-live="polite">
        <div class="word" id="word"></div>

        <div class="keyboard" id="keyboard" aria-hidden="false"></div>
      </div>
    </div>

    <div class="right">
      <div class="hangman-card">
        <div class="svg-wrap" aria-hidden="true">
          <!-- SVG hangman with strokes that appear progressively -->
          <svg id="hangman" viewBox="0 0 200 180" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">
            <!-- gallows -->
            <line x1="20" y1="170" x2="180" y2="170" stroke="#6b7280" stroke-width="3" stroke-linecap="round" opacity="0.9"/>
            <line x1="40" y1="170" x2="40" y2="20" stroke="#6b7280" stroke-width="4" stroke-linecap="round"/>
            <line x1="40" y1="20" x2="120" y2="20" stroke="#6b7280" stroke-width="4" stroke-linecap="round"/>
            <line x1="120" y1="20" x2="120" y2="36" stroke="#6b7280" stroke-width="4" stroke-linecap="round"/>

            <!-- parts (hidden by stroke-dasharray) -->
            <g id="parts" stroke="#102a43" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="none">
              <circle id="head" cx="120" cy="56" r="12" style="stroke-dasharray: 80; stroke-dashoffset: 80; transition: stroke-dashoffset .3s linear" />
              <line id="body" x1="120" y1="68" x2="120" y2="110" style="stroke-dasharray: 60; stroke-dashoffset: 60; transition: stroke-dashoffset .3s linear" />
              <line id="armL" x1="120" y1="78" x2="100" y2="94" style="stroke-dasharray: 40; stroke-dashoffset: 40; transition: stroke-dashoffset .3s linear" />
              <line id="armR" x1="120" y1="78" x2="140" y2="94" style="stroke-dasharray: 40; stroke-dashoffset: 40; transition: stroke-dashoffset .3s linear" />
              <line id="legL" x1="120" y1="110" x2="100" y2="140" style="stroke-dasharray: 50; stroke-dashoffset: 50; transition: stroke-dashoffset .3s linear" />
              <line id="legR" x1="120" y1="110" x2="140" y2="140" style="stroke-dasharray: 50; stroke-dashoffset: 50; transition: stroke-dashoffset .3s linear" />
            </g>
          </svg>
        </div>

        <div class="info">Lettere sbagliate: <span class="tries" id="wrongCount">0</span> / 6</div>
        <div class="controls">
          <button class="btn secondary" id="hintBtn">Mostra Indizio</button>
          <button class="btn primary" id="resetBtn">Ricomincia</button>
        </div>
      </div>

      <div class="hangman-card">
        <div style="text-align:center">
          <div style="font-size:13px;color:var(--muted)">Tema</div>
          <div style="font-weight:800;font-size:18px">Sorpresa</div>
        </div>
        <p style="margin:8px 0 0;color:var(--muted);font-size:13px; text-align:center">Un piccolo gioco: indovina la parola per scoprire la sorpresa.</p>
      </div>
    </div>

    
  </div>

  <!-- win overlay -->
  <div class="overlay" id="overlay" role="dialog" aria-modal="true">
    <div class="modal">
      <h2>H A I &nbsp; V I N T O</h2>
      <div class="prize">DUE GIORNI A ROMA!</div>
      <p class="sub">Prepara la valigia ‚Äî la sorpresa √® reale ‚úàÔ∏èüèõÔ∏è</p>
      <div style="display:flex; gap:10px; justify-content:center; margin-top:14px">
        <button class="btn primary" id="okBtn">Fantastico!</button>
        <button class="btn secondary" id="closeBtn">Chiudi</button>
      </div>
    </div>
    <canvas class="confetti" id="confetti"></canvas>
  </div>

  <script>
    // --- configuration ---
    const SECRET = 'COLOSSEO'; // parola da indovinare (maiusc)
    const MAX_WRONG = 6;

    // --- state ---
    let guessed = new Set();
    let wrong = new Set();

    // DOM
    const wordEl = document.getElementById('word');
    const keyboardEl = document.getElementById('keyboard');
    const wrongCountEl = document.getElementById('wrongCount');
    const overlay = document.getElementById('overlay');
    const okBtn = document.getElementById('okBtn');
    const closeBtn = document.getElementById('closeBtn');
    const hintBtn = document.getElementById('hintBtn');
    const resetBtn = document.getElementById('resetBtn');

    // letters for keyboard (italian alphabet simplified)
    const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');

    function init(){
      guessed.clear(); wrong.clear();
      // build blanks
      wordEl.innerHTML = '';
      for(let ch of SECRET){
        const d = document.createElement('div');
        d.className = 'letter hidden';
        d.dataset.letter = ch;
        d.textContent = ch; // keep letter in DOM but hidden via CSS so screen-readers still see
        wordEl.appendChild(d);
      }

      // build keyboard
      keyboardEl.innerHTML = '';
      for(let k of letters){
        const b = document.createElement('button');
        b.type = 'button';
        b.className = 'key';
        b.textContent = k;
        b.addEventListener('click', () => handleGuess(k, b));
        keyboardEl.appendChild(b);
      }

      updateUI();
      resetSVG();
    }

    function handleGuess(letter, btnEl){
      if(btnEl.classList.contains('disabled')) return;
      btnEl.classList.add('disabled');

      if(SECRET.includes(letter)){
        guessed.add(letter);
      } else {
        wrong.add(letter);
        drawPart(wrong.size - 1);
      }
      updateUI();
      checkEnd();
    }

    function updateUI(){
      // reveal letters
      for(let node of wordEl.children){
        const ch = node.dataset.letter;
        if(guessed.has(ch)){
          node.classList.remove('hidden');
          node.style.color = '#102a43';
        } else {
          node.classList.add('hidden');
          node.style.color = 'transparent';
        }
      }
      wrongCountEl.textContent = wrong.size;
    }

    function checkEnd(){
      // win?
      const allRevealed = [...SECRET].every(ch => guessed.has(ch));
      if(allRevealed){
        showWin();
        return;
      }
      // lose?
      if(wrong.size >= MAX_WRONG){
        revealAll();
        setTimeout(()=> alert('Hai esaurito i tentativi ‚Äî parola: ' + SECRET), 250);
      }
    }

    function revealAll(){
      for(let node of wordEl.children){ node.classList.remove('hidden'); node.style.color='#102a43' }
      // disable keyboard
      for(let b of keyboardEl.children) b.classList.add('disabled');
    }

    // --- SVG drawing control ---
    const parts = ['head','body','armL','armR','legL','legR'];
    function resetSVG(){
      for(let id of parts){
        const el = document.getElementById(id);
        if(el) el.style.strokeDashoffset = getComputedStyle(el).strokeDasharray || '0';
      }
      // set offsets to full
      document.getElementById('head').style.strokeDashoffset = '80';
      document.getElementById('body').style.strokeDashoffset = '60';
      document.getElementById('armL').style.strokeDashoffset = '40';
      document.getElementById('armR').style.strokeDashoffset = '40';
      document.getElementById('legL').style.strokeDashoffset = '50';
      document.getElementById('legR').style.strokeDashoffset = '50';
    }
    function drawPart(i){
      const id = parts[i];
      const el = document.getElementById(id);
      if(!el) return;
      el.style.strokeDashoffset = '0';
    }

    // --- Win overlay + confetti ---
    function showWin(){
      overlay.classList.add('show');
      startConfetti();
    }
    function hideWin(){
      overlay.classList.remove('show');
      stopConfetti();
    }

    okBtn.addEventListener('click', hideWin);
    closeBtn.addEventListener('click', hideWin);
    resetBtn.addEventListener('click', ()=>{
      init();
    });

    hintBtn.addEventListener('click', ()=>{
      // simple hint: length + first letter
      alert('Hint: parola di ' + SECRET.length + ' lettere, inizia con "' + SECRET[0] + '"');
    });

    // confetti (simple implementation)
    let confettiInterval;
    function startConfetti(){
      const canvas = document.getElementById('confetti');
      const ctx = canvas.getContext('2d');
      let w = canvas.width = window.innerWidth;
      let h = canvas.height = window.innerHeight;
      const pieces = [];
      for(let i=0;i<120;i++) pieces.push({x:Math.random()*w, y:Math.random()*h - h, vx:(Math.random()-0.5)*2, vy:1+Math.random()*3, size:4+Math.random()*6, rot:Math.random()*360, velr:(Math.random()-0.5)*6});
      function resize(){ w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight }
      window.addEventListener('resize', resize);
      function frame(){
        ctx.clearRect(0,0,w,h);
        for(let p of pieces){
          p.x += p.vx; p.y += p.vy; p.rot += p.velr;
          if(p.y > h + 20) { p.y = -20; p.x = Math.random()*w }
          ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.rot*Math.PI/180);
          ctx.fillStyle = 'rgba(230,57,70,0.9)';
          ctx.fillRect(-p.size/2,-p.size/2,p.size,p.size*0.6);
          ctx.restore();
        }
      }
      confettiInterval = setInterval(frame, 30);
    }
    function stopConfetti(){ clearInterval(confettiInterval); const c = document.getElementById('confetti'); const ctx = c.getContext('2d'); ctx && ctx.clearRect(0,0,c.width,c.height); }

    // keyboard with physical key support
    window.addEventListener('keydown', (e)=>{
      const key = e.key.toUpperCase();
      if(letters.includes(key)){
        // find the button
        const btn = [...keyboardEl.children].find(b => b.textContent === key);
        if(btn && !btn.classList.contains('disabled')) btn.click();
      }
    });

    // initialize on load
    init();
  </script>
</body>
</html>
